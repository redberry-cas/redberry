/*
 * Redberry: symbolic tensor computations.
 *
 * Copyright (c) 2010-2015:
 *   Stanislav Poslavsky   <stvlpos@mail.ru>
 *   Bolotin Dmitriy       <bolotin.dmitriy@gmail.com>
 *
 * This file is part of Redberry.
 *
 * Redberry is free software: you can redistribute it and/or modify
 * it under the terms of the GNU General Public License as published by
 * the Free Software Foundation, either version 3 of the License, or
 * (at your option) any later version.
 *
 * Redberry is distributed in the hope that it will be useful,
 * but WITHOUT ANY WARRANTY; without even the implied warranty of
 * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
 * GNU General Public License for more details.
 *
 * You should have received a copy of the GNU General Public License
 * along with Redberry. If not, see <http://www.gnu.org/licenses/>.
 */
package cc.redberry.physics.feyncalc;

import cc.redberry.core.TAssert;
import cc.redberry.core.context.CC;
import cc.redberry.core.context.OutputFormat;
import cc.redberry.core.indices.IndexType;
import cc.redberry.core.parser.preprocessor.GeneralIndicesInsertion;
import cc.redberry.core.tensor.Tensor;
import org.junit.Test;

import static cc.redberry.core.tensor.Tensors.parse;
import static cc.redberry.core.tensor.Tensors.parseSimple;

/**
 * Created by poslavsky on 07/08/15.
 */
public class DiracSimplifyTransformationTest {
    @Test
    public void test1() throws Exception {
        CC.setDefaultOutputFormat(OutputFormat.SimpleRedberry);
        GeneralIndicesInsertion indicesInsertion = new GeneralIndicesInsertion();
        CC.current().getParseManager().defaultParserPreprocessors.add(indicesInsertion);
        indicesInsertion.addInsertionRule(parseSimple("G^a'_b'a"), IndexType.Matrix1);
        indicesInsertion.addInsertionRule(parseSimple("G5^a'_b'"), IndexType.Matrix1);


        DiracSimplifyTransformation ds = new DiracSimplifyTransformation(parseSimple("G_a"), parseSimple("G5"));

        Tensor t;
        t = parse("G_a*G_b*G^a");
        TAssert.assertEquals("-2*G_b", ds.transform(t));

        t = parse("G5*G_a*G_b");
        TAssert.assertEquals("G_a*G_b*G5", ds.transform(t));

        t = parse("G5*G_a*G_b*G_c*G_d*p^a*p^d*G^c*G5*G^b + G5");
        TAssert.assertEquals("-4*p^{d}*p_{d} + G5", ds.transform(t));
    }

    @Test
    public void test2() throws Exception {
        CC.setDefaultOutputFormat(OutputFormat.SimpleRedberry);
        GeneralIndicesInsertion indicesInsertion = new GeneralIndicesInsertion();
        CC.current().getParseManager().defaultParserPreprocessors.add(indicesInsertion);
        indicesInsertion.addInsertionRule(parseSimple("G^a'_b'a"), IndexType.Matrix1);
        indicesInsertion.addInsertionRule(parseSimple("G5^a'_b'"), IndexType.Matrix1);
        indicesInsertion.addInsertionRule(parseSimple("cu_b'"), IndexType.Matrix1);
        indicesInsertion.addInsertionRule(parseSimple("u^b'"), IndexType.Matrix1);
        indicesInsertion.addInsertionRule(parseSimple("cv_b'"), IndexType.Matrix1);
        indicesInsertion.addInsertionRule(parseSimple("v^b'"), IndexType.Matrix1);

        DiracSimplifyTransformation ds = new DiracSimplifyTransformation(parseSimple("G_a"), parseSimple("G5"));

        Tensor t;
        t = parse("cu*G_a*G_b*G^a*u");
        TAssert.assertEquals("-2*cu*G_b*u", ds.transform(t));
    }

    @Test
    public void test3() throws Exception {
        for (int i = 0; i < 10; ++i) {
            CC.reset();

            CC.setDefaultOutputFormat(OutputFormat.SimpleRedberry);
            GeneralIndicesInsertion indicesInsertion = new GeneralIndicesInsertion();
            CC.current().getParseManager().defaultParserPreprocessors.add(indicesInsertion);
            indicesInsertion.addInsertionRule(parseSimple("G^a'_b'a"), IndexType.Matrix1);
            indicesInsertion.addInsertionRule(parseSimple("G5^a'_b'"), IndexType.Matrix1);
            indicesInsertion.addInsertionRule(parseSimple("T^A'_B'"), IndexType.Matrix2);

            indicesInsertion.addInsertionRule(parseSimple("cu_{a'A'}[p1_{m}[charm]]"), IndexType.Matrix1);
            indicesInsertion.addInsertionRule(parseSimple("cu_{a'A'}[p1_{m}[charm]]"), IndexType.Matrix2);

            indicesInsertion.addInsertionRule(parseSimple("v^b'B'[p2_a[charm]]"), IndexType.Matrix1);
            indicesInsertion.addInsertionRule(parseSimple("v^b'B'[p2_a[charm]]"), IndexType.Matrix2);

            DiracSimplifyTransformation ds = new DiracSimplifyTransformation(parseSimple("G_a"), parseSimple("G5"));
            Tensor t = parse("-378*cu_{a'A'}[p1_{m}[charm]]*T^{CA'}_{B'}*k1^{e}*k1^{k}*f_{BAC}*k2^{a}*k2_{b}*k2^{h}*G_{a}^{a'}_{b'}*e^{b}_{khe}*v^{b'B'}[p2_{m}[charm]]-294*cu_{a'B'}[p1_{m}[charm]]*k1^{e}*k1_{m}*k1^{k}*k1^{a}*k2^{h}*G^{da'}_{e'}*e^{b}_{khe}*e_{b}^{m}_{ad}*g_{BA}*v^{b'B'}[p2_{m}[charm]]*G5^{e'}_{b'}-1344*cu_{a'A'}[p1_{m}[charm]]*T^{CA'}_{B'}*k1^{a}*k1^{k}*k1^{e}*k2^{h}*p1_{m}[charm]*G^{da'}_{e'}*e^{b}_{khe}*e_{a}^{m}_{bd}*v^{b'B'}[p2_{m}[charm]]*d_{ABC}*G5^{e'}_{b'}+(-3654*I)*cu_{a'A'}[p1_{m}[charm]]*T^{CA'}_{B'}*k1^{e}*k1^{k}*k2^{h}*p1_{b}[charm]*e^{b}_{khe}*v^{a'B'}[p2_{m}[charm]]*d_{BAC}+(-126*I)*cu_{a'A'}[p1_{m}[charm]]*T^{CA'}_{B'}*k1^{k}*f_{BAC}*k2^{e}*k2_{m}*k2^{h}*p2^{a}[charm]*G^{da'}_{e'}*e^{b}_{khe}*e_{b}^{m}_{ad}*v^{b'B'}[p2_{m}[charm]]*G5^{e'}_{b'}+(-126*I)*cu_{a'A'}[p1_{m}[charm]]*T^{CA'}_{B'}*k1^{k}*k1^{e}*k2^{a}*k2^{h}*k2_{b}*G_{a}^{a'}_{b'}*e^{b}_{khe}*v^{b'B'}[p2_{m}[charm]]*d_{BAC}-84*cu_{a'B'}[p1_{m}[charm]]*k1^{k}*k2^{e}*k2^{h}*k2_{m}*p1^{a}[charm]*G^{da'}_{e'}*e^{b}_{khe}*e_{b}^{m}_{ad}*g_{BA}*v^{b'B'}[p2_{m}[charm]]*G5^{e'}_{b'}-126*cu_{a'A'}[p1_{m}[charm]]*T^{CA'}_{B'}*k1^{k}*f_{BAC}*k2^{a}*k2^{h}*p1_{b}[charm]*p2^{e}[charm]*G_{a}^{a'}_{b'}*e^{b}_{khe}*v^{b'B'}[p2_{m}[charm]]+((-42*I)*(-4+m[charm]**2)-42*I+(21*I)*(-5+m[charm]**2)+(-84*I)*m[charm]**2+(-42*I)*(2*m[charm]**2+4*m[bottom]**2-20)+(91*I)*(-3+m[charm]**2)+(-56*I)*(-2+m[charm]**2))*cu_{a'B'}[p1_{m}[charm]]*k1^{k}*k2^{h}*p2^{e}[charm]*G_{b}^{a'}_{b'}*e^{b}_{khe}*g_{BA}*v^{b'B'}[p2_{m}[charm]]-84*cu_{a'B'}[p1_{m}[charm]]*k1^{k}*k2^{h}*p1^{e}[charm]*p2^{a}[charm]*p2_{m}[charm]*G^{da'}_{e'}*e^{b}_{khe}*e_{b}^{m}_{ad}*g_{BA}*v^{b'B'}[p2_{m}[charm]]*G5^{e'}_{b'}-42*cu_{a'B'}[p1_{m}[charm]]*k1^{e}*k1^{k}*k2^{h}*k2_{m}*p2^{a}[charm]*G^{da'}_{e'}*e^{b}_{khe}*e_{b}^{m}_{ad}*g_{BA}*v^{b'B'}[p2_{m}[charm]]*G5^{e'}_{b'}+882*cu_{a'A'}[p1_{m}[charm]]*T^{CA'}_{B'}*k1^{a}*k1^{k}*k1_{m}*k2^{h}*p1^{e}[charm]*G^{da'}_{e'}*e_{b}^{m}_{ad}*e^{b}_{khe}*v^{b'B'}[p2_{m}[charm]]*d_{BAC}*G5^{e'}_{b'}+(-252*I)*cu_{a'A'}[p1_{m}[charm]]*T^{CA'}_{B'}*k1^{k}*f_{BAC}*k2^{h}*p1^{e}[charm]*p2^{a}[charm]*p2_{m}[charm]*G^{da'}_{e'}*e^{b}_{khe}*e_{b}^{m}_{ad}*v^{b'B'}[p2_{m}[charm]]*G5^{e'}_{b'}+(630*I)*cu_{b'A'}[p1_{m}[charm]]*T^{CA'}_{B'}*k1^{k}*k2^{h}*k2^{e}*p2_{b}[charm]*e^{b}_{khe}*v^{b'B'}[p2_{m}[charm]]*d_{ABC}+126*cu_{a'A'}[p1_{m}[charm]]*T^{CA'}_{B'}*k1^{k}*f_{BAC}*k2^{a}*k2^{h}*p2^{e}[charm]*G_{a}^{e'}_{b'}*G_{b}^{a'}_{e'}*e^{b}_{khe}*v^{b'B'}[p2_{m}[charm]]+252*cu_{a'A'}[p1_{m}[charm]]*T^{CA'}_{B'}*k1^{k}*k2^{h}*k2^{e}*p2_{m}[charm]*p2^{a}[charm]*G^{da'}_{e'}*e^{b}_{khe}*e_{b}^{m}_{ad}*v^{b'B'}[p2_{m}[charm]]*d_{BAC}*G5^{e'}_{b'}-252*cu_{a'A'}[p1_{m}[charm]]*T^{CA'}_{B'}*k1^{k}*k2_{m}*k2^{h}*k2^{e}*p1^{a}[charm]*G^{da'}_{e'}*e^{b}_{khe}*e_{b}^{m}_{ad}*v^{b'B'}[p2_{m}[charm]]*d_{BAC}*G5^{e'}_{b'}+(-420*I)*cu_{a'B'}[p1_{m}[charm]]*k1^{e}*k1^{k}*k2^{h}*k2_{b}*e^{b}_{khe}*g_{BA}*v^{a'B'}[p2_{m}[charm]]+(-840*I)*cu_{a'A'}[p1_{m}[charm]]*T^{CA'}_{B'}*k1^{a}*k1^{k}*k1^{e}*f_{ABC}*k2^{h}*p1_{m}[charm]*G^{da'}_{e'}*e^{b}_{khe}*e_{a}^{m}_{bd}*v^{b'B'}[p2_{m}[charm]]*G5^{e'}_{b'}+(252*I)*cu_{a'A'}[p1_{m}[charm]]*T^{CA'}_{B'}*k1^{k}*k2^{h}*p1_{b}[charm]*p1^{e}[charm]*e^{b}_{khe}*v^{a'B'}[p2_{m}[charm]]*d_{BAC}+378*cu_{a'A'}[p1_{m}[charm]]*T^{CA'}_{B'}*k1^{k}*k1^{a}*k2^{e}*k2_{m}*k2^{h}*G^{da'}_{e'}*e^{b}_{khe}*e_{b}^{m}_{ad}*v^{b'B'}[p2_{m}[charm]]*d_{BAC}*G5^{e'}_{b'}-882*cu_{a'A'}[p1_{m}[charm]]*T^{CA'}_{B'}*k1^{a}*k1^{k}*k1_{m}*k2^{h}*k2^{e}*G^{da'}_{e'}*e_{b}^{m}_{ad}*e^{b}_{khe}*v^{b'B'}[p2_{m}[charm]]*d_{BAC}*G5^{e'}_{b'}+(-126*I)*cu_{a'A'}[p1_{m}[charm]]*T^{CA'}_{B'}*k1^{k}*k1^{e}*f_{BAC}*k2_{m}*k2^{h}*p2^{a}[charm]*G^{da'}_{e'}*e^{b}_{khe}*e_{b}^{m}_{ad}*v^{b'B'}[p2_{m}[charm]]*G5^{e'}_{b'}+(-126*I)*cu_{a'A'}[p1_{m}[charm]]*T^{CA'}_{B'}*k1^{a}*k1^{e}*k1^{k}*f_{BAC}*k2_{m}*k2^{h}*G^{da'}_{e'}*e^{b}_{khe}*e_{b}^{m}_{ad}*v^{b'B'}[p2_{m}[charm]]*G5^{e'}_{b'}+((-42*I)*(-4+m[charm]**2)-42*I+(21*I)*(-5+m[charm]**2)+(-84*I)*m[charm]**2+(-42*I)*(2*m[charm]**2+4*m[bottom]**2-20)+(91*I)*(-3+m[charm]**2)+(-56*I)*(-2+m[charm]**2))*cu_{a'B'}[p1_{m}[charm]]*k1^{k}*k2^{h}*p1^{e}[charm]*G_{b}^{a'}_{e'}*e^{b}_{khe}*g_{BA}*v^{e'B'}[p2_{m}[charm]]+(252*I)*cu_{a'A'}[p1_{m}[charm]]*T^{CA'}_{B'}*k1^{k}*f_{BAC}*k2^{e}*k2_{m}*k2^{h}*p1^{a}[charm]*G^{da'}_{e'}*e^{b}_{khe}*e_{b}^{m}_{ad}*v^{b'B'}[p2_{m}[charm]]*G5^{e'}_{b'}+1344*cu_{a'A'}[p1_{m}[charm]]*T^{CA'}_{B'}*k1^{a}*k1^{k}*k2^{h}*p1_{m}[charm]*p1^{e}[charm]*G^{da'}_{e'}*e^{b}_{khe}*e_{a}^{m}_{bd}*v^{b'B'}[p2_{m}[charm]]*d_{ABC}*G5^{e'}_{b'}+126*cu_{a'A'}[p1_{m}[charm]]*T^{CA'}_{B'}*k1^{k}*f_{BAC}*k2^{a}*k2^{h}*p1^{e}[charm]*G_{a}^{e'}_{b'}*G_{b}^{a'}_{e'}*e^{b}_{khe}*v^{b'B'}[p2_{m}[charm]]-252*cu_{a'A'}[p1_{m}[charm]]*T^{CA'}_{B'}*k1^{k}*k2^{h}*p1_{m}[charm]*p1^{e}[charm]*p2^{a}[charm]*G^{da'}_{e'}*e^{b}_{khe}*e_{b}^{m}_{ad}*v^{b'B'}[p2_{m}[charm]]*d_{BAC}*G5^{e'}_{b'}+378*cu_{a'A'}[p1_{m}[charm]]*T^{CA'}_{B'}*k1^{k}*k1^{a}*k1^{e}*k2_{m}*k2^{h}*G^{da'}_{e'}*e^{b}_{khe}*e_{b}^{m}_{ad}*v^{b'B'}[p2_{m}[charm]]*d_{BAC}*G5^{e'}_{b'}+(42*I)*cu_{a'B'}[p1_{m}[charm]]*k1^{e}*k1^{k}*k2^{a}*k2^{h}*G_{a}^{e'}_{b'}*G_{b}^{a'}_{e'}*e^{b}_{khe}*g_{BA}*v^{b'B'}[p2_{m}[charm]]+378*cu_{a'A'}[p1_{m}[charm]]*T^{CA'}_{B'}*k1^{a}*k1^{k}*f_{BAC}*k2^{e}*k2_{b}*k2^{h}*G_{a}^{a'}_{b'}*e^{b}_{khe}*v^{b'B'}[p2_{m}[charm]]-42*cu_{a'B'}[p1_{m}[charm]]*k1^{k}*k2^{e}*k2^{h}*k2_{m}*p2^{a}[charm]*G^{da'}_{e'}*e^{b}_{khe}*e_{b}^{m}_{ad}*g_{BA}*v^{b'B'}[p2_{m}[charm]]*G5^{e'}_{b'}+126*cu_{a'B'}[p1_{m}[charm]]*k1^{e}*k1^{a}*k1^{k}*k2^{h}*k2_{m}*G^{da'}_{e'}*e^{b}_{khe}*e_{b}^{m}_{ad}*g_{BA}*v^{b'B'}[p2_{m}[charm]]*G5^{e'}_{b'}+(-378*I)*cu_{a'A'}[p1_{m}[charm]]*T^{CA'}_{B'}*k1^{k}*k2_{b}*k2^{e}*k2^{h}*e^{b}_{khe}*v^{a'B'}[p2_{m}[charm]]*d_{BAC}+(252*I)*cu_{a'A'}[p1_{m}[charm]]*T^{CA'}_{B'}*k1^{k}*k1^{e}*f_{BAC}*k2_{m}*k2^{h}*p1^{a}[charm]*G^{da'}_{e'}*e^{b}_{khe}*e_{b}^{m}_{ad}*v^{b'B'}[p2_{m}[charm]]*G5^{e'}_{b'}+(-196*I)*cu_{a'B'}[p1_{m}[charm]]*k1^{a}*k1^{k}*k2^{h}*p2^{e}[charm]*G_{a}^{a'}_{c'}*G_{b}^{c'}_{b'}*e^{b}_{khe}*g_{AB}*v^{b'B'}[p2_{m}[charm]]+(-252*I)*cu_{a'A'}[p1_{m}[charm]]*T^{CA'}_{B'}*k1^{k}*k2^{a}*k2^{h}*p2^{e}[charm]*G_{a}^{a'}_{c'}*G_{b}^{c'}_{b'}*e^{b}_{khe}*v^{b'B'}[p2_{m}[charm]]*d_{ABC}+(-42*I)*cu_{a'B'}[p1_{m}[charm]]*k1^{e}*k1^{k}*k2^{a}*k2^{h}*k2_{b}*G_{a}^{a'}_{b'}*e^{b}_{khe}*g_{BA}*v^{b'B'}[p2_{m}[charm]]-168*cu_{a'B'}[p1_{m}[charm]]*k1^{k}*k2^{h}*p1^{e}[charm]*p1^{a}[charm]*p1_{m}[charm]*G^{da'}_{e'}*e^{b}_{khe}*e_{b}^{m}_{ad}*g_{BA}*v^{b'B'}[p2_{m}[charm]]*G5^{e'}_{b'}+(504*I)*cu_{a'A'}[p1_{m}[charm]]*T^{CA'}_{B'}*k1^{k}*k2^{h}*p1_{b}[charm]*p2^{e}[charm]*e^{b}_{khe}*v^{a'B'}[p2_{m}[charm]]*d_{BAC}+(-378*I)*cu_{a'A'}[p1_{m}[charm]]*T^{CA'}_{B'}*k1^{k}*k2^{a}*k2^{h}*p1_{b}[charm]*p2^{e}[charm]*G_{a}^{a'}_{b'}*e^{b}_{khe}*v^{b'B'}[p2_{m}[charm]]*d_{BAC}+(-294*I)*cu_{a'A'}[p1_{m}[charm]]*T^{CA'}_{B'}*k1^{a}*k1^{k}*k2^{h}*p2^{e}[charm]*G_{a}^{e'}_{b'}*G_{b}^{a'}_{e'}*e^{b}_{khe}*v^{b'B'}[p2_{m}[charm]]*d_{BAC}+(210*I)*cu_{a'B'}[p1_{m}[charm]]*k1^{k}*k2^{h}*k2_{b}*p2^{e}[charm]*e^{b}_{khe}*g_{BA}*v^{a'B'}[p2_{m}[charm]]+1050*cu_{a'A'}[p1_{m}[charm]]*T^{CA'}_{B'}*k1^{a}*k1^{k}*k2^{h}*k2^{e}*p2_{m}[charm]*G^{da'}_{e'}*e^{b}_{khe}*e_{b}^{m}_{ad}*v^{b'B'}[p2_{m}[charm]]*d_{BAC}*G5^{e'}_{b'}+(-504*I)*cu_{a'A'}[p1_{m}[charm]]*T^{CA'}_{B'}*k1^{k}*f_{BAC}*k2^{h}*k2^{e}*p1^{a}[charm]*p1_{m}[charm]*G^{da'}_{e'}*e^{b}_{khe}*e_{b}^{m}_{ad}*v^{b'B'}[p2_{m}[charm]]*G5^{e'}_{b'}-1050*cu_{a'A'}[p1_{m}[charm]]*T^{CA'}_{B'}*k1^{a}*k1^{k}*k2^{h}*p1^{e}[charm]*p2_{m}[charm]*G^{da'}_{e'}*e^{b}_{khe}*e_{b}^{m}_{ad}*v^{b'B'}[p2_{m}[charm]]*d_{BAC}*G5^{e'}_{b'}-252*cu_{a'A'}[p1_{m}[charm]]*T^{CA'}_{B'}*k1^{k}*f_{BAC}*k2_{m}*k2^{h}*p1_{b}[charm]*p1^{e}[charm]*G^{ma'}_{b'}*e^{b}_{khe}*v^{b'B'}[p2_{m}[charm]]+294*cu_{a'A'}[p1_{m}[charm]]*T^{CA'}_{B'}*k1^{a}*k1^{k}*f_{ABC}*k2^{h}*p1_{b}[charm]*p2^{e}[charm]*G_{a}^{a'}_{b'}*e^{b}_{khe}*v^{b'B'}[p2_{m}[charm]]+(42*I)*cu_{a'A'}[p1_{m}[charm]]*T^{CA'}_{B'}*k1^{a}*k1^{k}*k2^{h}*p2_{b}[charm]*p2^{e}[charm]*G_{a}^{a'}_{b'}*e^{b}_{khe}*v^{b'B'}[p2_{m}[charm]]*d_{BAC}+168*cu_{a'B'}[p1_{m}[charm]]*k1^{e}*k1^{k}*k2^{h}*p1^{a}[charm]*p1_{m}[charm]*G^{da'}_{e'}*e^{b}_{khe}*e_{b}^{m}_{ad}*g_{BA}*v^{b'B'}[p2_{m}[charm]]*G5^{e'}_{b'}-350*cu_{a'B'}[p1_{m}[charm]]*k1^{k}*k1^{a}*k2^{h}*p2^{e}[charm]*p2_{m}[charm]*G^{da'}_{e'}*e^{b}_{khe}*e_{b}^{m}_{ad}*g_{BA}*v^{b'B'}[p2_{m}[charm]]*G5^{e'}_{b'}+(-252*I)*cu_{a'A'}[p1_{m}[charm]]*T^{CA'}_{B'}*k1^{k}*f_{BAC}*k2^{h}*p2^{a}[charm]*p2_{m}[charm]*p2^{e}[charm]*G^{da'}_{e'}*e^{b}_{khe}*e_{b}^{m}_{ad}*v^{b'B'}[p2_{m}[charm]]*G5^{e'}_{b'}+504*cu_{a'A'}[p1_{m}[charm]]*T^{CA'}_{B'}*k1^{k}*k1^{e}*k2^{h}*p1_{m}[charm]*p1^{a}[charm]*G^{da'}_{e'}*e^{b}_{khe}*e_{b}^{m}_{ad}*v^{b'B'}[p2_{m}[charm]]*d_{BAC}*G5^{e'}_{b'}+(238*I)*cu_{a'B'}[p1_{m}[charm]]*k1^{a}*k1^{k}*k2^{h}*k2_{b}*p1^{e}[charm]*G_{a}^{a'}_{b'}*e^{b}_{khe}*g_{BA}*v^{b'B'}[p2_{m}[charm]]+(-126*I)*cu_{a'B'}[p1_{m}[charm]]*k1^{k}*k2^{a}*k2^{h}*p1_{b}[charm]*p2^{e}[charm]*G_{a}^{a'}_{b'}*e^{b}_{khe}*g_{BA}*v^{b'B'}[p2_{m}[charm]]+252*cu_{a'A'}[p1_{m}[charm]]*T^{CA'}_{B'}*k1^{k}*k2^{h}*k2^{e}*p1_{m}[charm]*p2^{a}[charm]*G^{da'}_{e'}*e^{b}_{khe}*e_{b}^{m}_{ad}*v^{b'B'}[p2_{m}[charm]]*d_{BAC}*G5^{e'}_{b'}+((-63*I)*(-5+m[charm]**2)+(126*I)*(-4+m[charm]**2)+(168*I)*(-2+m[charm]**2)+(-273*I)*(-3+m[charm]**2)+(252*I)*m[charm]**2+(126*I)*(2*m[charm]**2+4*m[bottom]**2-20)+126*I)*cu_{a'A'}[p1_{m}[charm]]*T^{CA'}_{B'}*k1^{k}*k2^{e}*k2^{h}*G_{b}^{a'}_{c'}*e^{b}_{khe}*v^{c'B'}[p2_{m}[charm]]*d_{ABC}+(-42*I)*cu_{a'A'}[p1_{m}[charm]]*T^{CA'}_{B'}*k1^{a}*k1^{k}*f_{BAC}*k2^{h}*p1^{e}[charm]*p2_{m}[charm]*G^{da'}_{e'}*e^{b}_{khe}*e_{b}^{m}_{ad}*v^{b'B'}[p2_{m}[charm]]*G5^{e'}_{b'}-378*cu_{a'A'}[p1_{m}[charm]]*T^{CA'}_{B'}*k1^{k}*k1_{b}*k1^{e}*f_{BAC}*k2_{m}*k2^{h}*G^{ma'}_{b'}*e^{b}_{khe}*v^{b'B'}[p2_{m}[charm]]+(-252*I)*cu_{a'A'}[p1_{m}[charm]]*T^{CA'}_{B'}*k1^{k}*f_{BAC}*k2_{m}*k2^{h}*p1^{a}[charm]*p1^{e}[charm]*G^{da'}_{e'}*e^{b}_{khe}*e_{b}^{m}_{ad}*v^{b'B'}[p2_{m}[charm]]*G5^{e'}_{b'}-84*cu_{a'B'}[p1_{m}[charm]]*k1^{k}*k2^{h}*p1_{m}[charm]*p2^{e}[charm]*p2^{a}[charm]*G^{da'}_{e'}*e^{b}_{khe}*e_{b}^{m}_{ad}*g_{BA}*v^{b'B'}[p2_{m}[charm]]*G5^{e'}_{b'}+(-196*I)*cu_{a'B'}[p1_{m}[charm]]*k1^{a}*k1^{k}*k2^{h}*p1^{e}[charm]*G_{a}^{a'}_{c'}*G_{b}^{c'}_{b'}*e^{b}_{khe}*g_{AB}*v^{b'B'}[p2_{m}[charm]]+(-252*I)*cu_{a'A'}[p1_{m}[charm]]*T^{CA'}_{B'}*k1^{k}*k2^{a}*k2^{h}*p1^{e}[charm]*G_{a}^{a'}_{c'}*G_{b}^{c'}_{b'}*e^{b}_{khe}*v^{b'B'}[p2_{m}[charm]]*d_{ABC}-294*cu_{a'B'}[p1_{m}[charm]]*k1_{m}*k1^{k}*k1^{a}*k2^{e}*k2^{h}*G^{da'}_{e'}*e_{b}^{m}_{ad}*e^{b}_{khe}*g_{BA}*v^{b'B'}[p2_{m}[charm]]*G5^{e'}_{b'}-378*cu_{a'A'}[p1_{m}[charm]]*T^{CA'}_{B'}*k1^{k}*k1^{a}*k2_{m}*k2^{h}*p1^{e}[charm]*G^{da'}_{e'}*e^{b}_{khe}*e_{b}^{m}_{ad}*v^{b'B'}[p2_{m}[charm]]*d_{BAC}*G5^{e'}_{b'}+756*cu_{a'A'}[p1_{m}[charm]]*T^{CA'}_{B'}*k1^{k}*f_{BAC}*k2^{h}*p1^{e}[charm]*p1_{b}[charm]*e^{b}_{khe}*v^{a'B'}[p2_{m}[charm]]+(882*I)*cu_{a'B'}[p1_{m}[charm]]*k1^{k}*k1_{b}*k2^{h}*p2^{e}[charm]*e^{b}_{khe}*g_{BA}*v^{a'B'}[p2_{m}[charm]]+448*cu_{a'B'}[p1_{m}[charm]]*k1^{k}*k1^{a}*k2^{h}*p1_{m}[charm]*p2^{e}[charm]*G^{da'}_{e'}*e^{b}_{khe}*e_{a}^{m}_{bd}*g_{AB}*v^{b'B'}[p2_{m}[charm]]*G5^{e'}_{b'}-1344*cu_{a'A'}[p1_{m}[charm]]*T^{CA'}_{B'}*k1^{a}*k1^{e}*k1^{k}*f_{ABC}*k2^{h}*p1_{b}[charm]*G_{a}^{a'}_{b'}*e^{b}_{khe}*v^{b'B'}[p2_{m}[charm]]+(-294*I)*cu_{a'A'}[p1_{m}[charm]]*T^{CA'}_{B'}*k1^{a}*k1^{k}*k2^{h}*p1^{e}[charm]*G_{a}^{e'}_{b'}*G_{b}^{a'}_{e'}*e^{b}_{khe}*v^{b'B'}[p2_{m}[charm]]*d_{BAC}+(-504*I)*cu_{a'A'}[p1_{m}[charm]]*T^{CA'}_{B'}*k1^{k}*k1^{e}*f_{BAC}*k2^{h}*p1^{a}[charm]*p1_{m}[charm]*G^{da'}_{e'}*e^{b}_{khe}*e_{b}^{m}_{ad}*v^{b'B'}[p2_{m}[charm]]*G5^{e'}_{b'}+252*cu_{a'A'}[p1_{m}[charm]]*T^{CA'}_{B'}*k1^{k}*f_{BAC}*k2_{m}*k2^{h}*k2^{e}*p1_{b}[charm]*G^{ma'}_{b'}*e^{b}_{khe}*v^{b'B'}[p2_{m}[charm]]-1344*cu_{a'A'}[p1_{m}[charm]]*T^{CA'}_{B'}*k1^{a}*k1^{k}*k2^{h}*k2^{e}*p1_{m}[charm]*G^{da'}_{e'}*e^{b}_{khe}*e_{a}^{m}_{bd}*v^{b'B'}[p2_{m}[charm]]*d_{ABC}*G5^{e'}_{b'}+(-42*I)*cu_{a'A'}[p1_{m}[charm]]*T^{CA'}_{B'}*k1^{a}*k1^{k}*k1^{e}*k2^{h}*p2_{b}[charm]*G_{a}^{a'}_{b'}*e^{b}_{khe}*v^{b'B'}[p2_{m}[charm]]*d_{BAC}-126*cu_{a'B'}[p1_{m}[charm]]*k1^{a}*k1^{k}*k2^{h}*k2_{m}*p1^{e}[charm]*G^{da'}_{e'}*e^{b}_{khe}*e_{b}^{m}_{ad}*g_{BA}*v^{b'B'}[p2_{m}[charm]]*G5^{e'}_{b'}-168*cu_{a'B'}[p1_{m}[charm]]*k1^{k}*k2^{h}*p1^{a}[charm]*p1_{m}[charm]*p2^{e}[charm]*G^{da'}_{e'}*e^{b}_{khe}*e_{b}^{m}_{ad}*g_{BA}*v^{b'B'}[p2_{m}[charm]]*G5^{e'}_{b'}-504*cu_{a'A'}[p1_{m}[charm]]*T^{CA'}_{B'}*k1^{k}*k2^{h}*p1_{m}[charm]*p1^{a}[charm]*p2^{e}[charm]*G^{da'}_{e'}*e^{b}_{khe}*e_{b}^{m}_{ad}*v^{b'B'}[p2_{m}[charm]]*d_{BAC}*G5^{e'}_{b'}+(252*I)*cu_{a'A'}[p1_{m}[charm]]*T^{CA'}_{B'}*k1^{k}*k1_{b}*k2^{a}*k2^{h}*p2^{e}[charm]*G_{a}^{a'}_{b'}*e^{b}_{khe}*v^{b'B'}[p2_{m}[charm]]*d_{ABC}+(504*I)*cu_{a'A'}[p1_{m}[charm]]*T^{CA'}_{B'}*k1^{k}*f_{BAC}*k2^{h}*p1^{a}[charm]*p1_{m}[charm]*p1^{e}[charm]*G^{da'}_{e'}*e^{b}_{khe}*e_{b}^{m}_{ad}*v^{b'B'}[p2_{m}[charm]]*G5^{e'}_{b'}+(-42*I)*cu_{a'B'}[p1_{m}[charm]]*k1^{k}*k2^{a}*k2^{h}*p2^{e}[charm]*G_{a}^{e'}_{b'}*G_{b}^{a'}_{e'}*e^{b}_{khe}*g_{BA}*v^{b'B'}[p2_{m}[charm]]+(308*I)*cu_{a'B'}[p1_{m}[charm]]*k1^{a}*k1^{e}*k1^{k}*k2^{h}*p1_{b}[charm]*G_{a}^{a'}_{b'}*e^{b}_{khe}*g_{AB}*v^{b'B'}[p2_{m}[charm]]+(630*I)*cu_{a'A'}[p1_{m}[charm]]*T^{CA'}_{B'}*k1^{k}*k1_{b}*k2^{a}*k2^{h}*p1^{e}[charm]*G_{a}^{a'}_{b'}*e^{b}_{khe}*v^{b'B'}[p2_{m}[charm]]*d_{ABC}-126*cu_{a'A'}[p1_{m}[charm]]*T^{CA'}_{B'}*k1^{k}*f_{BAC}*k2_{m}*k2^{h}*p2_{b}[charm]*p2^{e}[charm]*G^{ma'}_{b'}*e^{b}_{khe}*v^{b'B'}[p2_{m}[charm]]+(42*I)*cu_{a'B'}[p1_{m}[charm]]*k1^{k}*k2^{a}*k2^{e}*k2^{h}*G_{a}^{e'}_{b'}*G_{b}^{a'}_{e'}*e^{b}_{khe}*g_{BA}*v^{b'B'}[p2_{m}[charm]]+(-588*I)*cu_{a'A'}[p1_{m}[charm]]*T^{CA'}_{B'}*k1^{a}*k1^{k}*k2^{h}*p2^{e}[charm]*G_{a}^{a'}_{c'}*G_{b}^{c'}_{b'}*e^{b}_{khe}*v^{b'B'}[p2_{m}[charm]]*d_{ABC}+(-756*I)*cu_{a'A'}[p1_{m}[charm]]*T^{CA'}_{B'}*k1^{k}*k1^{e}*f_{BAC}*k2^{h}*p1_{m}[charm]*p2^{a}[charm]*G^{da'}_{e'}*e^{b}_{khe}*e_{b}^{m}_{ad}*v^{b'B'}[p2_{m}[charm]]*G5^{e'}_{b'}+168*cu_{a'B'}[p1_{m}[charm]]*k1^{k}*k2^{e}*k2^{h}*p1^{a}[charm]*p1_{m}[charm]*G^{da'}_{e'}*e^{b}_{khe}*e_{b}^{m}_{ad}*g_{BA}*v^{b'B'}[p2_{m}[charm]]*G5^{e'}_{b'}-84*cu_{a'B'}[p1_{m}[charm]]*k1^{k}*k2^{h}*p1^{e}[charm]*p1_{m}[charm]*p2^{a}[charm]*G^{da'}_{e'}*e^{b}_{khe}*e_{b}^{m}_{ad}*g_{BA}*v^{b'B'}[p2_{m}[charm]]*G5^{e'}_{b'}+378*cu_{a'A'}[p1_{m}[charm]]*T^{CA'}_{B'}*k1^{a}*k1^{e}*k1^{k}*f_{BAC}*k2^{h}*k2_{b}*G_{a}^{a'}_{b'}*e^{b}_{khe}*v^{b'B'}[p2_{m}[charm]]+882*cu_{a'A'}[p1_{m}[charm]]*T^{CA'}_{B'}*k1^{a}*k1^{k}*k1_{m}*k2^{h}*p2^{e}[charm]*G^{da'}_{e'}*e_{b}^{m}_{ad}*e^{b}_{khe}*v^{b'B'}[p2_{m}[charm]]*d_{BAC}*G5^{e'}_{b'}-588*cu_{a'A'}[p1_{m}[charm]]*T^{CA'}_{B'}*k1^{a}*k1^{k}*k1^{e}*f_{ABC}*k2^{h}*G_{a}^{a'}_{c'}*G_{b}^{c'}_{b'}*e^{b}_{khe}*v^{b'B'}[p2_{m}[charm]]+252*cu_{a'A'}[p1_{m}[charm]]*T^{CA'}_{B'}*k1^{k}*k2_{m}*k2^{h}*p1^{a}[charm]*p2^{e}[charm]*G^{da'}_{e'}*e^{b}_{khe}*e_{b}^{m}_{ad}*v^{b'B'}[p2_{m}[charm]]*d_{BAC}*G5^{e'}_{b'}-294*cu_{a'A'}[p1_{m}[charm]]*T^{CA'}_{B'}*k1^{e}*k1^{k}*k1_{b}*f_{BAC}*k2^{h}*e^{b}_{khe}*v^{a'B'}[p2_{m}[charm]]+(-126*I)*cu_{a'A'}[p1_{m}[charm]]*T^{CA'}_{B'}*k1^{k}*k1_{b}*k1^{e}*k2_{m}*k2^{h}*G^{ma'}_{b'}*e^{b}_{khe}*v^{b'B'}[p2_{m}[charm]]*d_{BAC}-588*cu_{a'A'}[p1_{m}[charm]]*T^{CA'}_{B'}*k1^{a}*k1^{k}*f_{ABC}*k2^{e}*k2^{h}*G_{a}^{a'}_{c'}*G_{b}^{c'}_{b'}*e^{b}_{khe}*v^{b'B'}[p2_{m}[charm]]-252*cu_{a'A'}[p1_{m}[charm]]*T^{CA'}_{B'}*k1^{k}*k2^{h}*p1^{e}[charm]*p2_{m}[charm]*p2^{a}[charm]*G^{da'}_{e'}*e^{b}_{khe}*e_{b}^{m}_{ad}*v^{b'B'}[p2_{m}[charm]]*d_{BAC}*G5^{e'}_{b'}+(294*I)*cu_{a'A'}[p1_{m}[charm]]*T^{CA'}_{B'}*k1^{a}*k1^{k}*k1_{m}*k1^{e}*f_{BAC}*k2^{h}*G^{da'}_{e'}*e^{b}_{khe}*e_{b}^{m}_{ad}*v^{b'B'}[p2_{m}[charm]]*G5^{e'}_{b'}+966*cu_{a'A'}[p1_{m}[charm]]*T^{CA'}_{B'}*k1^{a}*k1^{k}*f_{BAC}*k2^{h}*k2_{b}*p1^{e}[charm]*G_{a}^{a'}_{b'}*e^{b}_{khe}*v^{b'B'}[p2_{m}[charm]]-378*cu_{a'A'}[p1_{m}[charm]]*T^{CA'}_{B'}*k1^{k}*k1_{b}*f_{ABC}*k2^{a}*k2^{h}*p1^{e}[charm]*G_{a}^{a'}_{b'}*e^{b}_{khe}*v^{b'B'}[p2_{m}[charm]]+(-840*I)*cu_{a'A'}[p1_{m}[charm]]*T^{CA'}_{B'}*k1^{a}*k1^{k}*f_{ABC}*k2^{h}*k2^{e}*p1_{m}[charm]*G^{da'}_{e'}*e^{b}_{khe}*e_{a}^{m}_{bd}*v^{b'B'}[p2_{m}[charm]]*G5^{e'}_{b'}+126*cu_{a'A'}[p1_{m}[charm]]*T^{CA'}_{B'}*k1^{k}*k2_{m}*k2^{h}*p2^{a}[charm]*p2^{e}[charm]*G^{da'}_{e'}*e^{b}_{khe}*e_{b}^{m}_{ad}*v^{b'B'}[p2_{m}[charm]]*d_{BAC}*G5^{e'}_{b'}+((42*I)*(-4+m[charm]**2)+42*I+(-21*I)*(-5+m[charm]**2)+(84*I)*m[charm]**2+(42*I)*(2*m[charm]**2+4*m[bottom]**2-20)+(-91*I)*(-3+m[charm]**2)+(56*I)*(-2+m[charm]**2))*cu_{a'B'}[p1_{m}[charm]]*k1^{k}*k2^{e}*k2^{h}*G_{b}^{a'}_{b'}*e^{b}_{khe}*g_{BA}*v^{b'B'}[p2_{m}[charm]]+(-42*I)*cu_{a'B'}[p1_{m}[charm]]*k1^{k}*k2^{a}*k2^{h}*p1^{e}[charm]*G_{a}^{e'}_{b'}*G_{b}^{a'}_{e'}*e^{b}_{khe}*g_{BA}*v^{b'B'}[p2_{m}[charm]]-630*cu_{a'A'}[p1_{m}[charm]]*T^{CA'}_{B'}*k1^{k}*f_{BAC}*k2^{h}*k2_{b}*p1^{e}[charm]*e^{b}_{khe}*v^{a'B'}[p2_{m}[charm]]+(126*I)*cu_{a'A'}[p1_{m}[charm]]*T^{CA'}_{B'}*k1^{a}*k1^{k}*k2_{b}*k2^{h}*k2^{e}*G_{a}^{a'}_{b'}*e^{b}_{khe}*v^{b'B'}[p2_{m}[charm]]*d_{BAC}-462*cu_{b'A'}[p1_{m}[charm]]*T^{CA'}_{B'}*k1^{k}*k1^{e}*f_{ABC}*k2^{h}*p2_{b}[charm]*e^{b}_{khe}*v^{b'B'}[p2_{m}[charm]]+((63*I)*(-5+m[charm]**2)+(-126*I)*(-4+m[charm]**2)+(-168*I)*(-2+m[charm]**2)+(273*I)*(-3+m[charm]**2)+(-252*I)*m[charm]**2+(-126*I)*(2*m[charm]**2+4*m[bottom]**2-20)-126*I)*cu_{a'A'}[p1_{m}[charm]]*T^{CA'}_{B'}*k1^{k}*k2^{h}*p2^{e}[charm]*G_{b}^{a'}_{e'}*e^{b}_{khe}*v^{e'B'}[p2_{m}[charm]]*d_{BAC}-350*cu_{a'B'}[p1_{m}[charm]]*k1^{k}*k1^{a}*k2^{h}*p1^{e}[charm]*p2_{m}[charm]*G^{da'}_{e'}*e^{b}_{khe}*e_{b}^{m}_{ad}*g_{BA}*v^{b'B'}[p2_{m}[charm]]*G5^{e'}_{b'}-504*cu_{a'A'}[p1_{m}[charm]]*T^{CA'}_{B'}*k1^{k}*k2^{h}*p1^{e}[charm]*p1_{m}[charm]*p1^{a}[charm]*G^{da'}_{e'}*e^{b}_{khe}*e_{b}^{m}_{ad}*v^{b'B'}[p2_{m}[charm]]*d_{BAC}*G5^{e'}_{b'}+(-588*I)*cu_{a'A'}[p1_{m}[charm]]*T^{CA'}_{B'}*k1^{a}*k1^{k}*k2^{h}*p1^{e}[charm]*G_{a}^{a'}_{c'}*G_{b}^{c'}_{b'}*e^{b}_{khe}*v^{b'B'}[p2_{m}[charm]]*d_{ABC}-126*cu_{a'A'}[p1_{m}[charm]]*T^{CA'}_{B'}*k1^{k}*k1^{e}*k2_{m}*k2^{h}*p2^{a}[charm]*G^{da'}_{e'}*e^{b}_{khe}*e_{b}^{m}_{ad}*v^{b'B'}[p2_{m}[charm]]*d_{BAC}*G5^{e'}_{b'}+(756*I)*cu_{a'A'}[p1_{m}[charm]]*T^{CA'}_{B'}*k1^{k}*f_{BAC}*k2^{h}*p1_{m}[charm]*p1^{e}[charm]*p2^{a}[charm]*G^{da'}_{e'}*e^{b}_{khe}*e_{b}^{m}_{ad}*v^{b'B'}[p2_{m}[charm]]*G5^{e'}_{b'}+(-42*I)*cu_{a'A'}[p1_{m}[charm]]*T^{CA'}_{B'}*k1^{a}*k1^{k}*f_{BAC}*k2^{h}*p2_{m}[charm]*p2^{e}[charm]*G^{da'}_{e'}*e^{b}_{khe}*e_{b}^{m}_{ad}*v^{b'B'}[p2_{m}[charm]]*G5^{e'}_{b'}+(252*I)*cu_{a'A'}[p1_{m}[charm]]*T^{CA'}_{B'}*k1^{k}*f_{BAC}*k2^{h}*k2^{e}*p2^{a}[charm]*p2_{m}[charm]*G^{da'}_{e'}*e^{b}_{khe}*e_{b}^{m}_{ad}*v^{b'B'}[p2_{m}[charm]]*G5^{e'}_{b'}+(252*I)*cu_{a'A'}[p1_{m}[charm]]*T^{CA'}_{B'}*k1^{k}*k2^{a}*k2^{h}*k2^{e}*G_{a}^{a'}_{c'}*G_{b}^{c'}_{b'}*e^{b}_{khe}*v^{b'B'}[p2_{m}[charm]]*d_{ABC}+(-84*I)*cu_{b'B'}[p1_{m}[charm]]*k1^{k}*k2^{h}*p2_{b}[charm]*p2^{e}[charm]*e^{b}_{khe}*g_{BA}*v^{b'B'}[p2_{m}[charm]]+84*cu_{a'B'}[p1_{m}[charm]]*k1^{k}*k2^{h}*k2_{m}*p1^{a}[charm]*p2^{e}[charm]*G^{da'}_{e'}*e^{b}_{khe}*e_{b}^{m}_{ad}*g_{BA}*v^{b'B'}[p2_{m}[charm]]*G5^{e'}_{b'}+126*cu_{a'A'}[p1_{m}[charm]]*T^{CA'}_{B'}*k1^{k}*f_{BAC}*k2_{m}*k2^{h}*k2^{e}*p2_{b}[charm]*G^{ma'}_{b'}*e^{b}_{khe}*v^{b'B'}[p2_{m}[charm]]+(168*I)*cu_{a'B'}[p1_{m}[charm]]*k1^{k}*k2^{h}*p1_{b}[charm]*p2^{e}[charm]*e^{b}_{khe}*g_{BA}*v^{a'B'}[p2_{m}[charm]]-882*cu_{b'A'}[p1_{m}[charm]]*T^{CA'}_{B'}*k1^{k}*f_{ABC}*k2^{h}*k2^{e}*p2_{b}[charm]*e^{b}_{khe}*v^{b'B'}[p2_{m}[charm]]+(126*I)*cu_{a'A'}[p1_{m}[charm]]*T^{CA'}_{B'}*k1^{k}*f_{BAC}*k2_{m}*k2^{h}*p2^{a}[charm]*p2^{e}[charm]*G^{da'}_{e'}*e^{b}_{khe}*e_{b}^{m}_{ad}*v^{b'B'}[p2_{m}[charm]]*G5^{e'}_{b'}+((63*I)*(-5+m[charm]**2)+(-126*I)*(-4+m[charm]**2)+(-168*I)*(-2+m[charm]**2)+(273*I)*(-3+m[charm]**2)+(-252*I)*m[charm]**2+(-126*I)*(2*m[charm]**2+4*m[bottom]**2-20)-126*I)*cu_{a'A'}[p1_{m}[charm]]*T^{CA'}_{B'}*k1^{k}*k2^{h}*p1^{e}[charm]*G_{b}^{a'}_{b'}*e^{b}_{khe}*v^{b'B'}[p2_{m}[charm]]*d_{BAC}+1344*cu_{a'A'}[p1_{m}[charm]]*T^{CA'}_{B'}*k1^{a}*k1^{k}*f_{ABC}*k2^{h}*p1^{e}[charm]*p1_{b}[charm]*G_{a}^{a'}_{b'}*e^{b}_{khe}*v^{b'B'}[p2_{m}[charm]]+84*cu_{a'B'}[p1_{m}[charm]]*k1^{e}*k1^{k}*k2^{h}*p2^{a}[charm]*p2_{m}[charm]*G^{da'}_{e'}*e^{b}_{khe}*e_{b}^{m}_{ad}*g_{BA}*v^{b'B'}[p2_{m}[charm]]*G5^{e'}_{b'}-1554*cu_{a'A'}[p1_{m}[charm]]*T^{CA'}_{B'}*k1^{k}*k1^{e}*f_{BAC}*k2^{h}*p1_{b}[charm]*e^{b}_{khe}*v^{a'B'}[p2_{m}[charm]]+(42*I)*cu_{a'B'}[p1_{m}[charm]]*k1^{a}*k1^{k}*k2^{h}*k2^{e}*k2_{b}*G_{a}^{a'}_{b'}*e^{b}_{khe}*g_{BA}*v^{b'B'}[p2_{m}[charm]]+252*cu_{a'A'}[p1_{m}[charm]]*T^{CA'}_{B'}*k1^{k}*k1^{e}*k2^{h}*p2_{m}[charm]*p2^{a}[charm]*G^{da'}_{e'}*e^{b}_{khe}*e_{b}^{m}_{ad}*v^{b'B'}[p2_{m}[charm]]*d_{BAC}*G5^{e'}_{b'}-252*cu_{a'A'}[p1_{m}[charm]]*T^{CA'}_{B'}*k1^{k}*k1^{e}*k2_{m}*k2^{h}*p1^{a}[charm]*G^{da'}_{e'}*e^{b}_{khe}*e_{b}^{m}_{ad}*v^{b'B'}[p2_{m}[charm]]*d_{BAC}*G5^{e'}_{b'}+(252*I)*cu_{a'A'}[p1_{m}[charm]]*T^{CA'}_{B'}*k1^{k}*k1^{e}*f_{BAC}*k2^{h}*p2^{a}[charm]*p2_{m}[charm]*G^{da'}_{e'}*e^{b}_{khe}*e_{b}^{m}_{ad}*v^{b'B'}[p2_{m}[charm]]*G5^{e'}_{b'}+(84*I)*cu_{a'B'}[p1_{m}[charm]]*k1^{e}*k1^{k}*k2^{a}*k2^{h}*G_{a}^{a'}_{c'}*G_{b}^{c'}_{b'}*e^{b}_{khe}*g_{AB}*v^{b'B'}[p2_{m}[charm]]+(-14*I)*cu_{a'B'}[p1_{m}[charm]]*k1_{m}*k1^{k}*k1_{b}*k2^{h}*p2^{e}[charm]*G^{ma'}_{b'}*e^{b}_{khe}*g_{BA}*v^{b'B'}[p2_{m}[charm]]+252*cu_{a'A'}[p1_{m}[charm]]*T^{CA'}_{B'}*k1^{k}*f_{ABC}*k2^{a}*k2^{h}*p2^{e}[charm]*G_{a}^{a'}_{c'}*G_{b}^{c'}_{b'}*e^{b}_{khe}*v^{b'B'}[p2_{m}[charm]]+(840*I)*cu_{a'A'}[p1_{m}[charm]]*T^{CA'}_{B'}*k1^{a}*k1^{k}*f_{ABC}*k2^{h}*p1_{m}[charm]*p2^{e}[charm]*G^{da'}_{e'}*e^{b}_{khe}*e_{a}^{m}_{bd}*v^{b'B'}[p2_{m}[charm]]*G5^{e'}_{b'}+294*cu_{a'B'}[p1_{m}[charm]]*k1_{m}*k1^{k}*k1^{a}*k2^{h}*p1^{e}[charm]*G^{da'}_{e'}*e_{b}^{m}_{ad}*e^{b}_{khe}*g_{BA}*v^{b'B'}[p2_{m}[charm]]*G5^{e'}_{b'}+126*cu_{a'B'}[p1_{m}[charm]]*k1^{a}*k1^{k}*k2^{e}*k2^{h}*k2_{m}*G^{da'}_{e'}*e^{b}_{khe}*e_{b}^{m}_{ad}*g_{BA}*v^{b'B'}[p2_{m}[charm]]*G5^{e'}_{b'}-84*cu_{a'B'}[p1_{m}[charm]]*k1^{k}*k2^{h}*p2^{e}[charm]*p2^{a}[charm]*p2_{m}[charm]*G^{da'}_{e'}*e^{b}_{khe}*e_{b}^{m}_{ad}*g_{BA}*v^{b'B'}[p2_{m}[charm]]*G5^{e'}_{b'}+(294*I)*cu_{a'A'}[p1_{m}[charm]]*T^{CA'}_{B'}*k1^{k}*k1_{m}*k1^{a}*f_{BAC}*k2^{h}*k2^{e}*G^{da'}_{e'}*e_{b}^{m}_{ad}*e^{b}_{khe}*v^{b'B'}[p2_{m}[charm]]*G5^{e'}_{b'}+(294*I)*cu_{a'A'}[p1_{m}[charm]]*T^{CA'}_{B'}*k1^{a}*k1^{k}*k2^{h}*k2^{e}*G_{a}^{e'}_{b'}*G_{b}^{a'}_{e'}*e^{b}_{khe}*v^{b'B'}[p2_{m}[charm]]*d_{BAC}+(840*I)*cu_{a'A'}[p1_{m}[charm]]*T^{CA'}_{B'}*k1^{a}*k1^{k}*f_{ABC}*k2^{h}*p1_{m}[charm]*p1^{e}[charm]*G^{da'}_{e'}*e^{b}_{khe}*e_{a}^{m}_{bd}*v^{b'B'}[p2_{m}[charm]]*G5^{e'}_{b'}+(42*I)*cu_{a'A'}[p1_{m}[charm]]*T^{CA'}_{B'}*k1^{a}*k1^{k}*k1^{e}*f_{BAC}*k2^{h}*p2_{m}[charm]*G^{da'}_{e'}*e^{b}_{khe}*e_{b}^{m}_{ad}*v^{b'B'}[p2_{m}[charm]]*G5^{e'}_{b'}+(-882*I)*cu_{a'A'}[p1_{m}[charm]]*T^{CA'}_{B'}*k1^{a}*k1^{k}*k2^{h}*p1_{b}[charm]*p2^{e}[charm]*G_{a}^{a'}_{b'}*e^{b}_{khe}*v^{b'B'}[p2_{m}[charm]]*d_{ABC}+294*cu_{a'A'}[p1_{m}[charm]]*T^{CA'}_{B'}*k1^{a}*k1^{k}*f_{BAC}*k2^{h}*p2^{e}[charm]*G_{a}^{e'}_{b'}*G_{b}^{a'}_{e'}*e^{b}_{khe}*v^{b'B'}[p2_{m}[charm]]+(84*I)*cu_{a'B'}[p1_{m}[charm]]*k1^{k}*k2^{h}*p1^{e}[charm]*p1_{b}[charm]*e^{b}_{khe}*g_{BA}*v^{a'B'}[p2_{m}[charm]]+(42*I)*cu_{b'B'}[p1_{m}[charm]]*k1^{k}*k2^{h}*k2_{b}*p1^{e}[charm]*e^{b}_{khe}*g_{BA}*v^{b'B'}[p2_{m}[charm]]+(252*I)*cu_{a'A'}[p1_{m}[charm]]*T^{CA'}_{B'}*k1^{k}*k2_{m}*k2^{h}*k2^{e}*p1_{b}[charm]*G^{ma'}_{b'}*e^{b}_{khe}*v^{b'B'}[p2_{m}[charm]]*d_{BAC}+(294*I)*cu_{a'A'}[p1_{m}[charm]]*T^{CA'}_{B'}*k1^{a}*k1^{k}*k1^{e}*k2^{h}*G_{a}^{e'}_{b'}*G_{b}^{a'}_{e'}*e^{b}_{khe}*v^{b'B'}[p2_{m}[charm]]*d_{BAC}-378*cu_{a'A'}[p1_{m}[charm]]*T^{CA'}_{B'}*k1^{k}*k1^{a}*k2_{m}*k2^{h}*p2^{e}[charm]*G^{da'}_{e'}*e^{b}_{khe}*e_{b}^{m}_{ad}*v^{b'B'}[p2_{m}[charm]]*d_{BAC}*G5^{e'}_{b'}+(98*I)*cu_{a'B'}[p1_{m}[charm]]*k1^{a}*k1^{e}*k1^{k}*k2^{h}*G_{a}^{e'}_{b'}*G_{b}^{a'}_{e'}*e^{b}_{khe}*g_{BA}*v^{b'B'}[p2_{m}[charm]]-126*cu_{b'A'}[p1_{m}[charm]]*T^{CA'}_{B'}*k1^{k}*f_{BAC}*k2_{b}*k2^{h}*k2^{e}*e^{b}_{khe}*v^{b'B'}[p2_{m}[charm]]+(196*I)*cu_{a'B'}[p1_{m}[charm]]*k1^{a}*k1^{e}*k1^{k}*k2^{h}*G_{a}^{a'}_{c'}*G_{b}^{c'}_{b'}*e^{b}_{khe}*g_{AB}*v^{b'B'}[p2_{m}[charm]]+(126*I)*cu_{a'A'}[p1_{m}[charm]]*T^{CA'}_{B'}*k1^{a}*k1^{e}*k1^{k}*k2^{h}*k2_{b}*G_{a}^{a'}_{b'}*e^{b}_{khe}*v^{b'B'}[p2_{m}[charm]]*d_{BAC}+(42*I)*cu_{a'B'}[p1_{m}[charm]]*k1^{a}*k1^{e}*k1^{k}*k2^{h}*k2_{b}*G_{a}^{a'}_{b'}*e^{b}_{khe}*g_{BA}*v^{b'B'}[p2_{m}[charm]]+252*cu_{a'A'}[p1_{m}[charm]]*T^{CA'}_{B'}*k1^{k}*f_{ABC}*k2^{a}*k2^{h}*p1^{e}[charm]*G_{a}^{a'}_{c'}*G_{b}^{c'}_{b'}*e^{b}_{khe}*v^{b'B'}[p2_{m}[charm]]+(14*I)*cu_{a'B'}[p1_{m}[charm]]*k1^{a}*k1^{k}*k2^{h}*p2_{b}[charm]*p2^{e}[charm]*G_{a}^{a'}_{b'}*e^{b}_{khe}*g_{BA}*v^{b'B'}[p2_{m}[charm]]+(-252*I)*cu_{a'A'}[p1_{m}[charm]]*T^{CA'}_{B'}*k1^{k}*k2_{m}*k2^{h}*p1_{b}[charm]*p1^{e}[charm]*G^{ma'}_{b'}*e^{b}_{khe}*v^{b'B'}[p2_{m}[charm]]*d_{BAC}+(252*I)*cu_{a'A'}[p1_{m}[charm]]*T^{CA'}_{B'}*k1^{k}*k1^{e}*k2^{a}*k2^{h}*G_{a}^{a'}_{c'}*G_{b}^{c'}_{b'}*e^{b}_{khe}*v^{b'B'}[p2_{m}[charm]]*d_{ABC}+(126*I)*cu_{a'A'}[p1_{m}[charm]]*T^{CA'}_{B'}*k1^{k}*k2^{a}*k2^{h}*k2^{e}*G_{a}^{e'}_{b'}*G_{b}^{a'}_{e'}*e^{b}_{khe}*v^{b'B'}[p2_{m}[charm]]*d_{BAC}+672*cu_{a'A'}[p1_{m}[charm]]*T^{CA'}_{B'}*k1^{a}*k1^{k}*f_{BAC}*k2^{h}*k2_{b}*p2^{e}[charm]*G_{a}^{a'}_{b'}*e^{b}_{khe}*v^{b'B'}[p2_{m}[charm]]-126*cu_{a'B'}[p1_{m}[charm]]*k1^{a}*k1^{k}*k2^{h}*k2_{m}*p2^{e}[charm]*G^{da'}_{e'}*e^{b}_{khe}*e_{b}^{m}_{ad}*g_{BA}*v^{b'B'}[p2_{m}[charm]]*G5^{e'}_{b'}-1050*cu_{a'A'}[p1_{m}[charm]]*T^{CA'}_{B'}*k1^{a}*k1^{k}*k2^{h}*p2_{m}[charm]*p2^{e}[charm]*G^{da'}_{e'}*e^{b}_{khe}*e_{b}^{m}_{ad}*v^{b'B'}[p2_{m}[charm]]*d_{BAC}*G5^{e'}_{b'}+350*cu_{a'B'}[p1_{m}[charm]]*k1^{k}*k1^{a}*k2^{e}*k2^{h}*p2_{m}[charm]*G^{da'}_{e'}*e^{b}_{khe}*e_{b}^{m}_{ad}*g_{BA}*v^{b'B'}[p2_{m}[charm]]*G5^{e'}_{b'}+84*cu_{a'B'}[p1_{m}[charm]]*k1^{k}*k2^{e}*k2^{h}*p2^{a}[charm]*p2_{m}[charm]*G^{da'}_{e'}*e^{b}_{khe}*e_{b}^{m}_{ad}*g_{BA}*v^{b'B'}[p2_{m}[charm]]*G5^{e'}_{b'}+294*cu_{a'A'}[p1_{m}[charm]]*T^{CA'}_{B'}*k1^{a}*k1^{k}*f_{BAC}*k2^{h}*p1^{e}[charm]*G_{a}^{e'}_{b'}*G_{b}^{a'}_{e'}*e^{b}_{khe}*v^{b'B'}[p2_{m}[charm]]+(-630*I)*cu_{b'A'}[p1_{m}[charm]]*T^{CA'}_{B'}*k1^{k}*k1^{e}*k2^{h}*p2_{b}[charm]*e^{b}_{khe}*v^{b'B'}[p2_{m}[charm]]*d_{ABC}+(-126*I)*cu_{a'A'}[p1_{m}[charm]]*T^{CA'}_{B'}*k1^{k}*k2^{a}*k2^{h}*p2^{e}[charm]*G_{a}^{e'}_{b'}*G_{b}^{a'}_{e'}*e^{b}_{khe}*v^{b'B'}[p2_{m}[charm]]*d_{BAC}+(126*I)*cu_{a'A'}[p1_{m}[charm]]*T^{CA'}_{B'}*k1^{k}*k1^{a}*f_{BAC}*k2_{m}*k2^{h}*p2^{e}[charm]*G^{da'}_{e'}*e^{b}_{khe}*e_{b}^{m}_{ad}*v^{b'B'}[p2_{m}[charm]]*G5^{e'}_{b'}-252*cu_{a'A'}[p1_{m}[charm]]*T^{CA'}_{B'}*k1^{k}*k2^{h}*p1_{m}[charm]*p2^{a}[charm]*p2^{e}[charm]*G^{da'}_{e'}*e^{b}_{khe}*e_{b}^{m}_{ad}*v^{b'B'}[p2_{m}[charm]]*d_{BAC}*G5^{e'}_{b'}+448*cu_{a'B'}[p1_{m}[charm]]*k1^{k}*k1^{a}*k2^{h}*p1^{e}[charm]*p1_{m}[charm]*G^{da'}_{e'}*e^{b}_{khe}*e_{a}^{m}_{bd}*g_{AB}*v^{b'B'}[p2_{m}[charm]]*G5^{e'}_{b'}+(-168*I)*cu_{a'A'}[p1_{m}[charm]]*T^{CA'}_{B'}*k1^{a}*k1^{k}*k2^{h}*k2_{b}*p2^{e}[charm]*G_{a}^{a'}_{b'}*e^{b}_{khe}*v^{b'B'}[p2_{m}[charm]]*d_{BAC}+(-56*I)*cu_{a'B'}[p1_{m}[charm]]*k1^{a}*k1^{k}*k2^{h}*k2_{b}*p2^{e}[charm]*G_{a}^{a'}_{b'}*e^{b}_{khe}*g_{BA}*v^{b'B'}[p2_{m}[charm]]+(504*I)*cu_{a'A'}[p1_{m}[charm]]*T^{CA'}_{B'}*k1^{k}*f_{BAC}*k2^{h}*p1_{m}[charm]*p1^{a}[charm]*p2^{e}[charm]*G^{da'}_{e'}*e^{b}_{khe}*e_{b}^{m}_{ad}*v^{b'B'}[p2_{m}[charm]]*G5^{e'}_{b'}+1344*cu_{a'A'}[p1_{m}[charm]]*T^{CA'}_{B'}*k1^{a}*k1^{k}*k2^{h}*p1_{m}[charm]*p2^{e}[charm]*G^{da'}_{e'}*e^{b}_{khe}*e_{a}^{m}_{bd}*v^{b'B'}[p2_{m}[charm]]*d_{ABC}*G5^{e'}_{b'}+350*cu_{a'B'}[p1_{m}[charm]]*k1^{e}*k1^{k}*k1^{a}*k2^{h}*p2_{m}[charm]*G^{da'}_{e'}*e^{b}_{khe}*e_{b}^{m}_{ad}*g_{BA}*v^{b'B'}[p2_{m}[charm]]*G5^{e'}_{b'}+1512*cu_{a'A'}[p1_{m}[charm]]*T^{CA'}_{B'}*k1^{k}*f_{BAC}*k2^{h}*p1_{b}[charm]*p2^{e}[charm]*e^{b}_{khe}*v^{a'B'}[p2_{m}[charm]]+(-252*I)*cu_{a'A'}[p1_{m}[charm]]*T^{CA'}_{B'}*k1^{k}*f_{BAC}*k2_{m}*k2^{h}*p1^{a}[charm]*p2^{e}[charm]*G^{da'}_{e'}*e^{b}_{khe}*e_{b}^{m}_{ad}*v^{b'B'}[p2_{m}[charm]]*G5^{e'}_{b'}+(98*I)*cu_{a'B'}[p1_{m}[charm]]*k1^{a}*k1^{k}*k2^{e}*k2^{h}*G_{a}^{e'}_{b'}*G_{b}^{a'}_{e'}*e^{b}_{khe}*g_{BA}*v^{b'B'}[p2_{m}[charm]]+(196*I)*cu_{a'B'}[p1_{m}[charm]]*k1^{a}*k1^{k}*k2^{e}*k2^{h}*G_{a}^{a'}_{c'}*G_{b}^{c'}_{b'}*e^{b}_{khe}*g_{AB}*v^{b'B'}[p2_{m}[charm]]+(84*I)*cu_{a'B'}[p1_{m}[charm]]*k1^{k}*k1_{b}*k2^{a}*k2^{h}*p2^{e}[charm]*G_{a}^{a'}_{b'}*e^{b}_{khe}*g_{AB}*v^{b'B'}[p2_{m}[charm]]+42*cu_{a'B'}[p1_{m}[charm]]*k1^{k}*k2^{h}*k2_{m}*p2^{e}[charm]*p2^{a}[charm]*G^{da'}_{e'}*e^{b}_{khe}*e_{b}^{m}_{ad}*g_{BA}*v^{b'B'}[p2_{m}[charm]]*G5^{e'}_{b'}+504*cu_{a'A'}[p1_{m}[charm]]*T^{CA'}_{B'}*k1^{k}*k2^{h}*k2^{e}*p1_{m}[charm]*p1^{a}[charm]*G^{da'}_{e'}*e^{b}_{khe}*e_{b}^{m}_{ad}*v^{b'B'}[p2_{m}[charm]]*d_{BAC}*G5^{e'}_{b'}+(84*I)*cu_{a'B'}[p1_{m}[charm]]*k1^{k}*k2^{a}*k2^{h}*k2_{b}*p1^{e}[charm]*G_{a}^{a'}_{b'}*e^{b}_{khe}*g_{BA}*v^{b'B'}[p2_{m}[charm]]-252*cu_{a'A'}[p1_{m}[charm]]*T^{CA'}_{B'}*k1^{k}*k1^{e}*f_{ABC}*k2^{a}*k2^{h}*G_{a}^{a'}_{c'}*G_{b}^{c'}_{b'}*e^{b}_{khe}*v^{b'B'}[p2_{m}[charm]]+1050*cu_{a'A'}[p1_{m}[charm]]*T^{CA'}_{B'}*k1^{a}*k1^{k}*k1^{e}*f_{BAC}*k2^{h}*p2_{b}[charm]*G_{a}^{a'}_{b'}*e^{b}_{khe}*v^{b'B'}[p2_{m}[charm]]+(-294*I)*cu_{a'A'}[p1_{m}[charm]]*T^{CA'}_{B'}*k1^{a}*k1^{k}*k1_{m}*f_{BAC}*k2^{h}*p2^{e}[charm]*G^{da'}_{e'}*e_{b}^{m}_{ad}*e^{b}_{khe}*v^{b'B'}[p2_{m}[charm]]*G5^{e'}_{b'}-448*cu_{a'B'}[p1_{m}[charm]]*k1^{k}*k1^{a}*k2^{e}*k2^{h}*p1_{m}[charm]*G^{da'}_{e'}*e^{b}_{khe}*e_{a}^{m}_{bd}*g_{AB}*v^{b'B'}[p2_{m}[charm]]*G5^{e'}_{b'}+(126*I)*cu_{a'A'}[p1_{m}[charm]]*T^{CA'}_{B'}*k1^{k}*k2_{m}*k2^{h}*p2_{b}[charm]*p2^{e}[charm]*G^{ma'}_{b'}*e^{b}_{khe}*v^{b'B'}[p2_{m}[charm]]*d_{BAC}-420*cu_{b'A'}[p1_{m}[charm]]*T^{CA'}_{B'}*k1^{e}*k1^{k}*f_{BAC}*k2^{h}*k2_{b}*e^{b}_{khe}*v^{b'B'}[p2_{m}[charm]]+(-126*I)*cu_{a'A'}[p1_{m}[charm]]*T^{CA'}_{B'}*k1^{k}*k2^{a}*k2^{h}*p1^{e}[charm]*G_{a}^{e'}_{b'}*G_{b}^{a'}_{e'}*e^{b}_{khe}*v^{b'B'}[p2_{m}[charm]]*d_{BAC}+(126*I)*cu_{a'A'}[p1_{m}[charm]]*T^{CA'}_{B'}*k1^{k}*k1^{a}*f_{BAC}*k2_{m}*k2^{h}*p1^{e}[charm]*G^{da'}_{e'}*e^{b}_{khe}*e_{b}^{m}_{ad}*v^{b'B'}[p2_{m}[charm]]*G5^{e'}_{b'}+(126*I)*cu_{b'A'}[p1_{m}[charm]]*T^{CA'}_{B'}*k1^{k}*k2^{h}*k2_{b}*p1^{e}[charm]*e^{b}_{khe}*v^{b'B'}[p2_{m}[charm]]*d_{BAC}+(588*I)*cu_{a'A'}[p1_{m}[charm]]*T^{CA'}_{B'}*k1^{a}*k1^{k}*k2^{h}*k2^{e}*G_{a}^{a'}_{c'}*G_{b}^{c'}_{b'}*e^{b}_{khe}*v^{b'B'}[p2_{m}[charm]]*d_{ABC}+(84*I)*cu_{a'B'}[p1_{m}[charm]]*k1^{k}*k2^{a}*k2^{e}*k2^{h}*G_{a}^{a'}_{c'}*G_{b}^{c'}_{b'}*e^{b}_{khe}*g_{AB}*v^{b'B'}[p2_{m}[charm]]+84*cu_{a'B'}[p1_{m}[charm]]*k1^{k}*k2^{e}*k2^{h}*p1_{m}[charm]*p2^{a}[charm]*G^{da'}_{e'}*e^{b}_{khe}*e_{b}^{m}_{ad}*g_{BA}*v^{b'B'}[p2_{m}[charm]]*G5^{e'}_{b'}+(-756*m[charm]**2-63*(-5+m[charm]**2)+231*(-3+m[charm]**2)-378*(2*m[charm]**2+4*m[bottom]**2-20)+84*(-2+m[charm]**2)-378-126*(-4+m[charm]**2))*cu_{a'A'}[p1_{m}[charm]]*T^{CA'}_{B'}*k1^{k}*f_{BAC}*k2^{h}*p2^{e}[charm]*G_{b}^{a'}_{e'}*e^{b}_{khe}*v^{e'B'}[p2_{m}[charm]]-252*cu_{a'A'}[p1_{m}[charm]]*T^{CA'}_{B'}*k1^{k}*k1_{b}*f_{ABC}*k2^{a}*k2^{h}*p2^{e}[charm]*G_{a}^{a'}_{b'}*e^{b}_{khe}*v^{b'B'}[p2_{m}[charm]]+(-294*I)*cu_{b'B'}[p1_{m}[charm]]*k1^{e}*k1^{k}*k1_{b}*k2^{h}*e^{b}_{khe}*g_{AB}*v^{b'B'}[p2_{m}[charm]]+(588*I)*cu_{a'A'}[p1_{m}[charm]]*T^{CA'}_{B'}*k1^{a}*k1^{k}*k1^{e}*k2^{h}*G_{a}^{a'}_{c'}*G_{b}^{c'}_{b'}*e^{b}_{khe}*v^{b'B'}[p2_{m}[charm]]*d_{ABC}+(756*I)*cu_{a'A'}[p1_{m}[charm]]*T^{CA'}_{B'}*k1^{k}*f_{BAC}*k2^{h}*p1_{m}[charm]*p2^{a}[charm]*p2^{e}[charm]*G^{da'}_{e'}*e^{b}_{khe}*e_{b}^{m}_{ad}*v^{b'B'}[p2_{m}[charm]]*G5^{e'}_{b'}-126*cu_{a'A'}[p1_{m}[charm]]*T^{CA'}_{B'}*k1^{k}*k1^{e}*f_{BAC}*k2^{a}*k2^{h}*G_{a}^{e'}_{b'}*G_{b}^{a'}_{e'}*e^{b}_{khe}*v^{b'B'}[p2_{m}[charm]]+(-126*I)*cu_{a'A'}[p1_{m}[charm]]*T^{CA'}_{B'}*k1^{k}*k1^{a}*f_{BAC}*k2^{e}*k2_{m}*k2^{h}*G^{da'}_{e'}*e^{b}_{khe}*e_{b}^{m}_{ad}*v^{b'B'}[p2_{m}[charm]]*G5^{e'}_{b'}+42*cu_{a'B'}[p1_{m}[charm]]*k1^{k}*k2^{h}*k2_{m}*p1^{e}[charm]*p2^{a}[charm]*G^{da'}_{e'}*e^{b}_{khe}*e_{b}^{m}_{ad}*g_{BA}*v^{b'B'}[p2_{m}[charm]]*G5^{e'}_{b'}-294*cu_{a'A'}[p1_{m}[charm]]*T^{CA'}_{B'}*k1^{a}*k1^{k}*k1^{e}*f_{BAC}*k2^{h}*G_{a}^{e'}_{b'}*G_{b}^{a'}_{e'}*e^{b}_{khe}*v^{b'B'}[p2_{m}[charm]]+(-280*I)*cu_{a'B'}[p1_{m}[charm]]*k1^{a}*k1^{k}*k2^{h}*p1^{e}[charm]*p1_{b}[charm]*G_{a}^{a'}_{b'}*e^{b}_{khe}*g_{AB}*v^{b'B'}[p2_{m}[charm]]+(126*I)*cu_{a'A'}[p1_{m}[charm]]*T^{CA'}_{B'}*k1^{k}*k1^{e}*k2^{a}*k2^{h}*G_{a}^{e'}_{b'}*G_{b}^{a'}_{e'}*e^{b}_{khe}*v^{b'B'}[p2_{m}[charm]]*d_{BAC}+(-84*I)*cu_{a'B'}[p1_{m}[charm]]*k1^{k}*k2_{m}*k2^{h}*p1_{b}[charm]*p1^{e}[charm]*G^{ma'}_{b'}*e^{b}_{khe}*g_{BA}*v^{b'B'}[p2_{m}[charm]]-252*cu_{a'A'}[p1_{m}[charm]]*T^{CA'}_{B'}*k1^{k}*f_{ABC}*k2^{a}*k2^{h}*k2^{e}*G_{a}^{a'}_{c'}*G_{b}^{c'}_{b'}*e^{b}_{khe}*v^{b'B'}[p2_{m}[charm]]+588*cu_{a'A'}[p1_{m}[charm]]*T^{CA'}_{B'}*k1^{a}*k1^{k}*f_{ABC}*k2^{h}*p2^{e}[charm]*G_{a}^{a'}_{c'}*G_{b}^{c'}_{b'}*e^{b}_{khe}*v^{b'B'}[p2_{m}[charm]]-882*cu_{a'A'}[p1_{m}[charm]]*T^{CA'}_{B'}*k1^{a}*k1^{k}*k1_{m}*k1^{e}*k2^{h}*G^{da'}_{e'}*e^{b}_{khe}*e_{b}^{m}_{ad}*v^{b'B'}[p2_{m}[charm]]*d_{BAC}*G5^{e'}_{b'}+(-756*I)*cu_{a'A'}[p1_{m}[charm]]*T^{CA'}_{B'}*k1^{k}*f_{BAC}*k2^{h}*k2^{e}*p1_{m}[charm]*p2^{a}[charm]*G^{da'}_{e'}*e^{b}_{khe}*e_{b}^{m}_{ad}*v^{b'B'}[p2_{m}[charm]]*G5^{e'}_{b'}-294*cu_{a'A'}[p1_{m}[charm]]*T^{CA'}_{B'}*k1^{a}*k1^{k}*f_{BAC}*k2^{e}*k2^{h}*G_{a}^{e'}_{b'}*G_{b}^{a'}_{e'}*e^{b}_{khe}*v^{b'B'}[p2_{m}[charm]]+(-84*I)*cu_{a'B'}[p1_{m}[charm]]*k1^{k}*k2^{a}*k2^{h}*p2^{e}[charm]*G_{a}^{a'}_{c'}*G_{b}^{c'}_{b'}*e^{b}_{khe}*g_{AB}*v^{b'B'}[p2_{m}[charm]]+(42*I)*cu_{a'B'}[p1_{m}[charm]]*k1^{k}*k2_{m}*k2^{h}*p2_{b}[charm]*p2^{e}[charm]*G^{ma'}_{b'}*e^{b}_{khe}*g_{BA}*v^{b'B'}[p2_{m}[charm]]-448*cu_{a'B'}[p1_{m}[charm]]*k1^{e}*k1^{k}*k1^{a}*k2^{h}*p1_{m}[charm]*G^{da'}_{e'}*e^{b}_{khe}*e_{a}^{m}_{bd}*g_{AB}*v^{b'B'}[p2_{m}[charm]]*G5^{e'}_{b'}+(-1218*I)*cu_{a'B'}[p1_{m}[charm]]*k1^{e}*k1^{k}*k2^{h}*p1_{b}[charm]*e^{b}_{khe}*g_{BA}*v^{a'B'}[p2_{m}[charm]]+(-126*I)*cu_{a'A'}[p1_{m}[charm]]*T^{CA'}_{B'}*k1^{k}*k2^{a}*k2^{h}*k2_{b}*p2^{e}[charm]*G_{a}^{a'}_{b'}*e^{b}_{khe}*v^{b'B'}[p2_{m}[charm]]*d_{BAC}+(126*I)*cu_{a'B'}[p1_{m}[charm]]*k1_{b}*k1^{k}*k2_{m}*k2^{h}*p1^{e}[charm]*G^{ma'}_{b'}*e^{b}_{khe}*g_{BA}*v^{b'B'}[p2_{m}[charm]]+(-756*m[charm]**2-63*(-5+m[charm]**2)+231*(-3+m[charm]**2)-378*(2*m[charm]**2+4*m[bottom]**2-20)+84*(-2+m[charm]**2)-378-126*(-4+m[charm]**2))*cu_{a'A'}[p1_{m}[charm]]*T^{CA'}_{B'}*k1^{k}*f_{BAC}*k2^{h}*p1^{e}[charm]*G_{b}^{a'}_{e'}*e^{b}_{khe}*v^{e'B'}[p2_{m}[charm]]+(-756*m[charm]**2-63*(-5+m[charm]**2)+231*(-3+m[charm]**2)-378*(2*m[charm]**2+4*m[bottom]**2-20)+84*(-2+m[charm]**2)-378-126*(-4+m[charm]**2))*cu_{a'A'}[p1_{m}[charm]]*T^{CA'}_{B'}*k1^{k}*f_{ABC}*k2^{h}*k2^{e}*G_{b}^{a'}_{c'}*e^{b}_{khe}*v^{c'B'}[p2_{m}[charm]]+(840*I)*cu_{a'A'}[p1_{m}[charm]]*T^{CA'}_{B'}*k1^{a}*k1^{e}*k1^{k}*k2^{h}*p1_{b}[charm]*G_{a}^{a'}_{b'}*e^{b}_{khe}*v^{b'B'}[p2_{m}[charm]]*d_{ABC}+252*cu_{a'A'}[p1_{m}[charm]]*T^{CA'}_{B'}*k1^{k}*k2_{m}*k2^{h}*p1^{a}[charm]*p1^{e}[charm]*G^{da'}_{e'}*e^{b}_{khe}*e_{b}^{m}_{ad}*v^{b'B'}[p2_{m}[charm]]*d_{BAC}*G5^{e'}_{b'}+(-294*I)*cu_{a'A'}[p1_{m}[charm]]*T^{CA'}_{B'}*k1^{a}*k1^{k}*k1_{m}*f_{BAC}*k2^{h}*p1^{e}[charm]*G^{da'}_{e'}*e_{b}^{m}_{ad}*e^{b}_{khe}*v^{b'B'}[p2_{m}[charm]]*G5^{e'}_{b'}-252*cu_{a'A'}[p1_{m}[charm]]*T^{CA'}_{B'}*k1^{k}*k2^{h}*p2^{e}[charm]*p2_{m}[charm]*p2^{a}[charm]*G^{da'}_{e'}*e^{b}_{khe}*e_{b}^{m}_{ad}*v^{b'B'}[p2_{m}[charm]]*d_{BAC}*G5^{e'}_{b'}-126*cu_{a'A'}[p1_{m}[charm]]*T^{CA'}_{B'}*k1^{k}*f_{BAC}*k2^{a}*k2^{h}*k2^{e}*G_{a}^{e'}_{b'}*G_{b}^{a'}_{e'}*e^{b}_{khe}*v^{b'B'}[p2_{m}[charm]]+(-42*I)*cu_{a'B'}[p1_{m}[charm]]*k1^{k}*k2^{a}*k2^{h}*k2_{b}*p2^{e}[charm]*G_{a}^{a'}_{b'}*e^{b}_{khe}*g_{BA}*v^{b'B'}[p2_{m}[charm]]+(-840*I)*cu_{a'A'}[p1_{m}[charm]]*T^{CA'}_{B'}*k1^{a}*k1^{k}*k2^{h}*p1^{e}[charm]*p1_{b}[charm]*G_{a}^{a'}_{b'}*e^{b}_{khe}*v^{b'B'}[p2_{m}[charm]]*d_{ABC}+(-126*I)*cu_{b'B'}[p1_{m}[charm]]*k1^{k}*k2^{e}*k2^{h}*k2_{b}*e^{b}_{khe}*g_{BA}*v^{b'B'}[p2_{m}[charm]]-84*cu_{a'B'}[p1_{m}[charm]]*k1^{e}*k1^{k}*k2^{h}*k2_{m}*p1^{a}[charm]*G^{da'}_{e'}*e^{b}_{khe}*e_{b}^{m}_{ad}*g_{BA}*v^{b'B'}[p2_{m}[charm]]*G5^{e'}_{b'}+(-98*I)*cu_{a'B'}[p1_{m}[charm]]*k1^{a}*k1^{k}*k2^{h}*p2^{e}[charm]*G_{a}^{e'}_{b'}*G_{b}^{a'}_{e'}*e^{b}_{khe}*g_{BA}*v^{b'B'}[p2_{m}[charm]]+(-756*m[charm]**2-63*(-5+m[charm]**2)+231*(-3+m[charm]**2)-378*(2*m[charm]**2+4*m[bottom]**2-20)+84*(-2+m[charm]**2)-378-126*(-4+m[charm]**2))*cu_{a'A'}[p1_{m}[charm]]*T^{CA'}_{B'}*k1^{e}*k1^{k}*f_{ABC}*k2^{h}*G_{b}^{a'}_{c'}*e^{b}_{khe}*v^{c'B'}[p2_{m}[charm]]+588*cu_{a'A'}[p1_{m}[charm]]*T^{CA'}_{B'}*k1^{a}*k1^{k}*f_{ABC}*k2^{h}*p1^{e}[charm]*G_{a}^{a'}_{c'}*G_{b}^{c'}_{b'}*e^{b}_{khe}*v^{b'B'}[p2_{m}[charm]]+1050*cu_{a'A'}[p1_{m}[charm]]*T^{CA'}_{B'}*k1^{a}*k1^{k}*k1^{e}*k2^{h}*p2_{m}[charm]*G^{da'}_{e'}*e^{b}_{khe}*e_{b}^{m}_{ad}*v^{b'B'}[p2_{m}[charm]]*d_{BAC}*G5^{e'}_{b'}+((-63*I)*(-5+m[charm]**2)+(126*I)*(-4+m[charm]**2)+(168*I)*(-2+m[charm]**2)+(-273*I)*(-3+m[charm]**2)+(252*I)*m[charm]**2+(126*I)*(2*m[charm]**2+4*m[bottom]**2-20)+126*I)*cu_{a'A'}[p1_{m}[charm]]*T^{CA'}_{B'}*k1^{e}*k1^{k}*k2^{h}*G_{b}^{a'}_{c'}*e^{b}_{khe}*v^{c'B'}[p2_{m}[charm]]*d_{ABC}+126*cu_{a'A'}[p1_{m}[charm]]*T^{CA'}_{B'}*k1^{k}*k2_{m}*k2^{h}*p1^{e}[charm]*p2^{a}[charm]*G^{da'}_{e'}*e^{b}_{khe}*e_{b}^{m}_{ad}*v^{b'B'}[p2_{m}[charm]]*d_{BAC}*G5^{e'}_{b'}+(-294*I)*cu_{a'B'}[p1_{m}[charm]]*k1^{a}*k1^{k}*k2^{h}*p1_{b}[charm]*p2^{e}[charm]*G_{a}^{a'}_{b'}*e^{b}_{khe}*g_{AB}*v^{b'B'}[p2_{m}[charm]]+(-882*I)*cu_{b'A'}[p1_{m}[charm]]*T^{CA'}_{B'}*k1^{e}*k1^{k}*k1_{b}*k2^{h}*e^{b}_{khe}*v^{b'B'}[p2_{m}[charm]]*d_{ABC}+294*cu_{a'B'}[p1_{m}[charm]]*k1_{m}*k1^{k}*k1^{a}*k2^{h}*p2^{e}[charm]*G^{da'}_{e'}*e_{b}^{m}_{ad}*e^{b}_{khe}*g_{BA}*v^{b'B'}[p2_{m}[charm]]*G5^{e'}_{b'}-1050*cu_{a'A'}[p1_{m}[charm]]*T^{CA'}_{B'}*k1^{a}*k1^{k}*f_{BAC}*k2^{h}*p2_{b}[charm]*p2^{e}[charm]*G_{a}^{a'}_{b'}*e^{b}_{khe}*v^{b'B'}[p2_{m}[charm]]+(-84*I)*cu_{a'B'}[p1_{m}[charm]]*k1^{k}*k2^{a}*k2^{h}*p1^{e}[charm]*G_{a}^{a'}_{c'}*G_{b}^{c'}_{b'}*e^{b}_{khe}*g_{AB}*v^{b'B'}[p2_{m}[charm]]+(714*I)*cu_{a'A'}[p1_{m}[charm]]*T^{CA'}_{B'}*k1^{a}*k1^{k}*k2^{h}*k2_{b}*p1^{e}[charm]*G_{a}^{a'}_{b'}*e^{b}_{khe}*v^{b'B'}[p2_{m}[charm]]*d_{BAC}-756*cu_{b'A'}[p1_{m}[charm]]*T^{CA'}_{B'}*k1^{k}*f_{BAC}*k2^{h}*p2_{b}[charm]*p2^{e}[charm]*e^{b}_{khe}*v^{b'B'}[p2_{m}[charm]]+((42*I)*(-4+m[charm]**2)+42*I+(-21*I)*(-5+m[charm]**2)+(84*I)*m[charm]**2+(42*I)*(2*m[charm]**2+4*m[bottom]**2-20)+(-91*I)*(-3+m[charm]**2)+(56*I)*(-2+m[charm]**2))*cu_{a'B'}[p1_{m}[charm]]*k1^{e}*k1^{k}*k2^{h}*G_{b}^{a'}_{c'}*e^{b}_{khe}*g_{AB}*v^{c'B'}[p2_{m}[charm]]+84*cu_{a'B'}[p1_{m}[charm]]*k1^{k}*k2^{h}*k2_{m}*p1^{e}[charm]*p1^{a}[charm]*G^{da'}_{e'}*e^{b}_{khe}*e_{b}^{m}_{ad}*g_{BA}*v^{b'B'}[p2_{m}[charm]]*G5^{e'}_{b'}+252*cu_{a'A'}[p1_{m}[charm]]*T^{CA'}_{B'}*k1^{k}*k1^{e}*k2^{h}*p1_{m}[charm]*p2^{a}[charm]*G^{da'}_{e'}*e^{b}_{khe}*e_{b}^{m}_{ad}*v^{b'B'}[p2_{m}[charm]]*d_{BAC}*G5^{e'}_{b'}+(-42*I)*cu_{a'B'}[p1_{m}[charm]]*k1^{e}*k1_{b}*k1^{k}*k2_{m}*k2^{h}*G^{ma'}_{b'}*e^{b}_{khe}*g_{BA}*v^{b'B'}[p2_{m}[charm]]+84*cu_{a'B'}[p1_{m}[charm]]*k1^{e}*k1^{k}*k2^{h}*p1_{m}[charm]*p2^{a}[charm]*G^{da'}_{e'}*e^{b}_{khe}*e_{b}^{m}_{ad}*g_{BA}*v^{b'B'}[p2_{m}[charm]]*G5^{e'}_{b'}+(-252*I)*cu_{b'A'}[p1_{m}[charm]]*T^{CA'}_{B'}*k1^{k}*k2^{h}*p2_{b}[charm]*p2^{e}[charm]*e^{b}_{khe}*v^{b'B'}[p2_{m}[charm]]*d_{BAC}+(42*I)*cu_{a'A'}[p1_{m}[charm]]*T^{CA'}_{B'}*k1^{a}*k1^{k}*f_{BAC}*k2^{h}*k2^{e}*p2_{m}[charm]*G^{da'}_{e'}*e^{b}_{khe}*e_{b}^{m}_{ad}*v^{b'B'}[p2_{m}[charm]]*G5^{e'}_{b'}+(126*I)*cu_{a'A'}[p1_{m}[charm]]*T^{CA'}_{B'}*k1^{k}*f_{BAC}*k2_{m}*k2^{h}*p1^{e}[charm]*p2^{a}[charm]*G^{da'}_{e'}*e^{b}_{khe}*e_{b}^{m}_{ad}*v^{b'B'}[p2_{m}[charm]]*G5^{e'}_{b'}+(-98*I)*cu_{a'B'}[p1_{m}[charm]]*k1^{a}*k1^{k}*k2^{h}*p1^{e}[charm]*G_{a}^{e'}_{b'}*G_{b}^{a'}_{e'}*e^{b}_{khe}*g_{BA}*v^{b'B'}[p2_{m}[charm]]+(-1260*I)*cu_{a'A'}[p1_{m}[charm]]*T^{CA'}_{B'}*k1^{e}*k1^{k}*k2^{h}*k2_{b}*e^{b}_{khe}*v^{a'B'}[p2_{m}[charm]]*d_{BAC}-126*cu_{a'A'}[p1_{m}[charm]]*T^{CA'}_{B'}*k1^{k}*k2_{m}*k2^{h}*k2^{e}*p2^{a}[charm]*G^{da'}_{e'}*e^{b}_{khe}*e_{b}^{m}_{ad}*v^{b'B'}[p2_{m}[charm]]*d_{BAC}*G5^{e'}_{b'}");
            TAssert.assertTrue(t == ds.transform(t));
        }
    }


    @Test
    public void test4() throws Exception {

        CC.setDefaultOutputFormat(OutputFormat.SimpleRedberry);
        GeneralIndicesInsertion indicesInsertion = new GeneralIndicesInsertion();
        CC.current().getParseManager().defaultParserPreprocessors.add(indicesInsertion);
        indicesInsertion.addInsertionRule(parseSimple("G^a'_b'a"), IndexType.Matrix1);
        indicesInsertion.addInsertionRule(parseSimple("G5^a'_b'"), IndexType.Matrix1);
        indicesInsertion.addInsertionRule(parseSimple("cu_a'"), IndexType.Matrix1);
        indicesInsertion.addInsertionRule(parseSimple("v^b'"), IndexType.Matrix1);

        DiracSimplifyTransformation ds = new DiracSimplifyTransformation(parseSimple("G_a"), parseSimple("G5"));
        Tensor t = parse("Tr[G_a*G_b*G5*G_c*G_d]*p^b*p^c");
        System.out.println(ds.transform(t));
        TAssert.assertTrue(t != ds.transform(t));
    }

}